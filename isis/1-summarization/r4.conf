# vR4 Configuration (Edge)
# Handles route leaking and summarization.
## Interfaces
set chassis aggregated-devices ethernet device-count 1
del interfaces ge-0/0/0 unit 0
del interfaces ge-0/0/1 unit 0
set interfaces ge-0/0/0 gigether-options 802.3ad ae0
set interfaces ge-0/0/1 gigether-options 802.3ad ae0
set interfaces ae0 aggregated-ether-options lacp active
set interfaces ae0 unit 0 family inet address 172.20.0.3/31
set protocols lldp interface all
set interfaces lo0 unit 0 family inet address 172.16.0.4/32
del interfaces ge-0/0/5 unit 0
set interfaces ge-0/0/5 flexible-vlan-tagging
set interfaces ge-0/0/5 unit 204 vlan-id 204 family inet address 172.30.0.57/30
## IS-IS Configuration
### 1. Configure family ISO NET Address (Area 49.0002)
set interfaces ae0 unit 0 family iso
set interfaces lo0 unit 0 family iso address 49.0002.1720.1600.0004.00
set interfaces ge-0/0/2 unit 0 family iso
set interfaces ge-0/0/3 unit 0 family iso
### 2. Backbone Links (L1 Only)
del protocols isis
set protocols isis level 2 disable
set protocols isis interface ae0 point-to-point
set protocols isis interface ge-0/0/3 point-to-point
### 3. Loopback and wide metrics
set protocols isis interface lo0 passive
set protocols isis level 1 wide-metrics-only
set protocols isis level 2 wide-metrics-only

### Summarization (L1 to L2)
### Create the aggregate route first
set routing-options aggregate route 192.168.0.0/16
### Export it to IS-IS L2, rejecting specifics is implicit in L1->L2 default behavior usually, but use policy to be explicit
set policy-options policy-statement summarize-to-l2 term send_summary from protocol aggregate
set policy-options policy-statement summarize-to-l2 term send_summary from route-filter 192.168.0.0/16 exact
set policy-options policy-statement summarize-to-l2 term send_summary then accept
set policy-options policy-statement summarize-to-l2 term suppress_l1 from level 1
set policy-options policy-statement summarize-to-l2 term suppress_l1 then reject
set policy-options policy-statement summarize-to-l2 term reject-specifics from protocol isis
set policy-options policy-statement summarize-to-l2 term reject-specifics from level 1
set policy-options policy-statement summarize-to-l2 term reject-specifics from route-filter 192.168.0.0/16 prefix-length-range /17-/32
set policy-options policy-statement summarize-to-l2 term reject-specifics to level 2
set policy-options policy-statement summarize-to-l2 term reject-specifics then reject
