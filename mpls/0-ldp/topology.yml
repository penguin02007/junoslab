provider: clab
defaults.device: vmx
module: [ vlan ]

nodes:
  vr1:
    id: 1
    mgmt.ifname: fxp0
  vr2:
    id: 2
    mgmt.ifname: fxp0
  vr3:
    id: 3
    mgmt.ifname: fxp0
  vr4:
    id: 4
    mgmt.ifname: fxp0
  vr5:
    id: 5
    mgmt.ifname: fxp0
  vr6:
    id: 6
    mgmt.ifname: fxp0
  vr7:
    id: 7
    mgmt.ifname: fxp0
  vr8:
    id: 8
    mgmt.ifname: fxp0

vlans:
  r1_r2:
    id: 100
    mode: route
  r2_r3:
    id: 110
    mode: route
  r3_r4:
    id: 120
    mode: route
  r4_r5:
    id: 130
    mode: route
  r5_r6:
    id: 140
    mode: route
  r6_r7:
    id: 150
    mode: route
  r7_r8:
    id: 160
    mode: route
  r8_r1:
    id: 170
    mode: route
  r2_r7:
    id: 180
    mode: route
  r3_r6:
    id: 190
    mode: route
  r1_r4:
    id: 200
    mode: route
  r8_r5:
    id: 210
    mode: route
 
links:
  - r1:
      ifindex: 0
      name: r1->r2 (ae0)
      unnumbered: true
    r2:
      ifindex: 0
      name: r2->r1 (ae0)
      unnumbered: true
  - r1:
      ifindex: 1
      name: r1->r2 (ae0)
      unnumbered: true
    r2:
      ifindex: 1
      name: r1->r2 (ae0)
      unnumbered: true
  - r2:
      ifindex: 3
      name: r2->r3
    r3:
      ifindex: 3
      name: r3->r2
    vlan.trunk: [ red ]
  - r1:
      ifindex: 3
      name: r1->r4
      ipv4: 172.20.0.25/31
      type: p2p
    r4:
      ifindex: 3
      name: r4->r1
      ipv4: 172.20.0.24/31
      type: p2p
  - r3:
      ifindex: 0
      name: r3->r4 (ae0)
      unnumbered: true
    r4:
      ifindex: 0
      name: r4->r3 (ae0)
      unnumbered: true
  - r3:
      ifindex: 1
      name: r3->r4 (ae0)
      unnumbered: true
    r4:
      ifindex: 1
      name: r4->r3 (ae0)
      unnumbered: true
  - r4:
      ifindex: 2
      name: r4->r2
      ipv4: 172.20.0.19/31
      type: p2p
    r2:
      ifindex: 2
      name: r1->r4
      ipv4: 172.20.0.18/31
      type: p2p
  - r1:
      ifindex: 2
      name: r4->r1
      ipv4: 172.20.0.35/31
      type: p2p
    r3:
      ifindex: 2
      name: r1->r3
      ipv4: 172.20.0.34/31
      type: p2p
  - dc2:
      ifindex: 4
      name: r2->dc2
      ipv4: 172.30.0.50/30
      type: p2p
    r2:
      ifindex: 4
      name: dc2->r2
      ipv4: 172.30.0.49/30
      type: p2p
  - dc2:
      ifindex: 5
      name: r4->dc2
      ipv4: 172.30.0.58/30
      type: p2p
    r4:
      ifindex: 5
      name: dc2->r4
      ipv4: 172.30.0.57/30
      type: p2p
addressing:
  loopback:
    ipv4: 172.16.0.0/24
    prefix: 32
  p2p:
    ipv4: 172.20.0.0/24
    prefix: 31
